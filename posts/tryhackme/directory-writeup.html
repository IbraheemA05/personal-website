<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Directory - TryHackMe Writeup | Ibraheem's Portfolio</title>
    <link rel="stylesheet" href="../../styles.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="logo">
          <i class="fas fa-terminal"></i>
          <span>ibraheemA05@cybersec:~$</span>
        </div>
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <nav class="nav" id="nav">
          <a href="../../index.html" class="nav-link">Home</a>
          <a href="index.html" class="nav-link active">TryHackMe</a>
          <a href="../articles/index.html" class="nav-link">Articles</a>
          <a href="../projects/index.html" class="nav-link">Projects</a>
          <a href="../../index.html#contact" class="nav-link">Contact</a>
        </nav>
      </header>

      <main class="main">
        <section class="writeup-hero">
          <div class="writeup-hero-content">
            <div class="breadcrumb">
              <a href="../../index.html">Home</a>
              <span>/</span>
              <a href="index.html">TryHackMe</a>
              <span>/</span>
              <span>Directory</span>
            </div>

            <h1 class="writeup-hero-title">
              <i class="fas fa-folder-open"></i>
              Directory - TryHackMe Writeup
            </h1>

            <div class="writeup-meta">
              <div class="meta-item">
                <i class="fas fa-calendar"></i>
                <span>July 22, 2025</span>
              </div>
              <div class="meta-item">
                <i class="fas fa-signal"></i>
                <span class="difficulty-easy">Hard</span>
              </div>
              <div class="meta-item">
                <i class="fas fa-clock"></i>
                <span>~120 minutes</span>
              </div>
              <div class="meta-item">
                <i class="fas fa-tags"></i>
                <span>Digital Forensics, Network Analysis</span>
              </div>
            </div>

            <div class="room-link">
              <a href="https://tryhackme.com/room/directorydfirroom" target="_blank" class="thm-link">
                <i class="fas fa-external-link-alt"></i>
                View Room on TryHackMe
              </a>
            </div>

            <p class="writeup-description">
              A Digital Forensics room focusing on network traffic analysis using Wireshark and Tshark. 
              Investigate a security breach at a music company by analyzing PCAP files to uncover the attack timeline.
            </p>
          </div>
        </section>

        <section class="writeup-content">
          <div class="content-container">
            <div class="table-of-contents">
              <h3>Table of Contents</h3>
              <ul>
                <li><a href="#overview">Room Overview</a></li>
                <li><a href="#scenario">Incident Scenario</a></li>
                <li><a href="#analysis">Traffic Analysis</a></li>
                <li><a href="#questions">Question Walkthrough</a></li>
                <li><a href="#takeaways">Key Takeaways</a></li>
              </ul>
            </div>

            <div class="writeup-main">
                            <section id="overview" class="content-section">
                <h2>
                  <i class="fas fa-info-circle"></i>
                  Room Overview
                </h2>
                <div class="info-box">
                  <p>
                    The Directory room is a Digital Forensics challenge that focuses on network traffic analysis. 
                    As a cybersecurity analyst, I investigated a security breach at a music company using 
                    PCAP file analysis with Wireshark and Tshark.
                  </p>
                  <div class="room-stats">
                    <div class="stat">
                      <strong>Difficulty:</strong> HARD
                    </div>
                    <div class="stat">
                      <strong>Learning Focus:</strong> Digital Forensics & Network Analysis
                    </div>
                    <div class="stat">
                      <strong>Tools Used:</strong> Wireshark, Tshark, Hashcat, Python Scripts
                    </div>
                  </div>
                </div>

                <div class="screenshot-box">
                  <h4><i class="fas fa-image"></i> Room Introduction</h4>
                  <div class="image-container">
                    <img src="../../assets/images/tryhackme/directory/Directory.png" alt="TryHackMe Directory Room" class="writeup-image" />
                    <p class="image-caption">TryHackMe Directory Room - Digital Forensics Investigation</p>
                  </div>
                </div>
              </section>

              <section id="scenario" class="content-section">
                <h2>
                  <i class="fas fa-exclamation-triangle"></i>
                  Incident Scenario
                </h2>
                <div class="scenario-box">
                  <h3>üéµ The Case</h3>
                  <p>
                    A small music company was recently hit by a threat actor. The company's Art Directory, 
                    Larry, claims to have discovered a random note on his Desktop.
                  </p>
                  <p>
                    Given that they are just starting, they did not have time to properly set up the 
                    appropriate tools for capturing artifacts. Their IT contact only set up <strong>Wireshark</strong>, 
                    which captured the events in question.
                  </p>
                  <div class="mission-objective">
                    <h4>üéØ My Mission:</h4>
                    <p>
                      Find out how this attack unfolded and what the threat actor executed on the system 
                      by analyzing the provided <code>traffic.pcap</code> file.
                    </p>
                  </div>
                </div>

                <div class="warning-box">
                  <h4>‚ö†Ô∏è Important Security Note</h4>
                  <p>
                    In real-world scenarios, PCAP files should be analyzed in an isolated virtual machine 
                    to prevent spreading of any malware or payload that may be contained within the traffic.
                  </p>
                </div>
              </section>

              <section id="analysis" class="content-section">
                <h2>
                  <i class="fas fa-search"></i>
                  Initial Traffic Analysis
                </h2>
                <p>
                  My investigation begins with downloading the PCAP file and loading it into Wireshark. 
                  Let me start by identifying the key players in this network traffic.
                </p>

                <div class="screenshot-box">
                  <h4><i class="fas fa-terminal"></i> Initial Questions Overview</h4>
                  <div class="image-container">
                    <img src="../../assets/images/tryhackme/directory/question0.jpeg" alt="TryHackMe questions overview" class="writeup-image" />
                    <p class="image-caption">Overview of the investigation questions I need to answer</p>
                  </div>
                </div>

                <h3>üîç Identifying Source IP Addresses</h3>
                <p>First, let me identify all source IP addresses in the traffic to find the attacker:</p>

                <div class="code-block">
                  <div class="code-header">
                    <span class="code-title">Extract Unique Source IPs</span>
                    <button class="copy-btn" onclick="copyCode(this)">
                      <i class="fas fa-copy"></i>
                    </button>
                  </div>
                  <pre><code class="language-bash">tshark -r traffic.pcap -T fields -e ip.src | sort -u</code></pre>
                </div>

                <div class="results-box">
                  <h4>Analysis Results:</h4>
                  <p>
                    After reviewing the source IPs, I can identify <strong>10.0.2.74</strong> as the likely 
                    attacker IP based on the connection patterns and behavior in the traffic.
                  </p>
                </div>
              </section>

              <section id="questions" class="content-section">
                <h2>
                  <i class="fas fa-question-circle"></i>
                  Question Walkthrough
                </h2>

                <div class="question-block">
                  <h3>Question 1: Port Discovery</h3>
                  <p><strong>What ports did the threat actor initially find open?</strong></p>
                  <p><em>Format: from lowest to highest, separated by a comma</em></p>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Identify Open Ports via SYN Scans</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">tshark -r traffic.pcap -Y "ip.src==10.0.2.74 && tcp.flags.syn==1 && tcp.flags.ack==0" -T fields -e tcp.dstport | sort | uniq</code></pre>
                  </div>

                  <div class="explanation-box">
                    <p>
                      This command filters for SYN packets (connection attempts) from the attacker IP to 
                      identify which ports they were scanning/accessing.
                    </p>
                  </div>

                  <div class="explanation-box">
                    <p>
                      <strong>Rabbit hole:</strong> At first, I tried to identify the open ports using Wireshark‚Äôs graphical interface. After spending several minutes without success, I realized I needed a more efficient approach. That‚Äôs when I switched to <strong>tshark</strong> (the CLI version of Wireshark), which allowed me to quickly filter and extract the port information I needed.
                    </p>
                  </div>
                </div>

                <div class="question-block">
                  <h3>Question 2: Valid Username Discovery</h3>
                  <p><strong>The threat actor found four valid usernames, but only one username allowed the attacker to achieve a foothold on the server. What was the username?</strong></p>
                  <p><em>Format: Domain.TLD\username</em></p>

                  <h4>üîç Kerberos Analysis</h4>
                  <p>Using Wireshark to analyze Kerberos authentication attempts:</p>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Wireshark Filter for Kerberos</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">kerberos</code></pre>
                  </div>

                  <div class="explanation-box">
                    <p>
                      By filtering Kerberos traffic, I can observe authentication attempts and identify 
                      which username was successfully used to gain access to the system.
                    </p>
                  </div>
                </div>

                <div class="question-block">
                  <h3>Question 3: Hash Extraction</h3>
                  <p><strong>The threat actor captured a hash from the user in question 2. What are the last 30 characters of that hash?</strong></p>

                  <p>For this question, I used a specialized Python script to extract Kerberos hashes:</p>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Download Krb5RoastParser Script</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">wget https://raw.githubusercontent.com/jalvarezz13/Krb5RoastParser/refs/heads/main/krb5_roast_parser.py</code></pre>
                  </div>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Extract AS-REP Hash</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">python3 krb5_roast_parser.py traffic.pcap as_rep</code></pre>
                  </div>

                  <div class="screenshot-box">
                    <h4><i class="fas fa-key"></i> Hash Extraction Results</h4>
                    <div class="image-container">
                      <img src="../../assets/images/tryhackme/directory/question3.jpeg" alt="Extracted Kerberos hash" class="writeup-image" />
                      <p class="image-caption">Successfully extracted AS-REP hash from the PCAP file</p>
                    </div>
                  </div>
                </div>

                <div class="question-block">
                  <h3>Question 4: Password Cracking</h3>
                  <p><strong>What is the user's password?</strong></p>

                  <p>Using Hashcat to brute force the extracted hash:</p>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Hashcat Password Cracking</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">hashcat -m 18200 hash.txt /usr/share/wordlists/rockyou.txt</code></pre>
                  </div>
                  <div class="explanation-box">
                    <p>
                       <strong>Hashcat:</strong> I used Hashcat for password cracking. To run Hashcat effectively, you need to specify the correct module using the <code>-m</code> flag. In this case, I used module <code>18200</code>, which is designed for Kerberos AS-REP hashes. This allowed me to brute-force the hash and recover the user's password.
                    </p>
                  </div>
                  <div class="screenshot-box">
                    <h4><i class="fas fa-unlock"></i> Password Cracking Success</h4>
                    <div class="image-container">
                      <img src="../../assets/images/tryhackme/directory/question4.jpeg" alt="Cracked password result" class="writeup-image" />
                      <p class="image-caption">Successfully cracked the user's password using Hashcat</p>
                    </div>
                  </div>
                </div>

                <div class="question-block">
                  <h3>Questions 5 & 6: Command Execution Analysis</h3>
                  <p><strong>What were the second and third commands that the threat actor executed on the system?</strong></p>
                  <p><em>Format: command1,command2</em></p>

                  <h4>üîì WinRM Traffic Decryption</h4>
                  <p>To analyze the commands executed, I need to decrypt the WinRM traffic using the cracked password:</p>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Download WinRM Decryption Script</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">wget https://gist.githubusercontent.com/jborean93/d6ff5e87f8a9f5cb215cd49826523045/raw/0f7782d317a4e6e7830282aa7430289f7f97dabe/winrm_decrypt.py</code></pre>
                  </div>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Decrypt WinRM Traffic</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">python3 winrm_decrypt.py -p 'PASSWORD_FROM_QUESTION4' traffic.pcap > decrypted.txt</code></pre>
                  </div>

                  <h4>üìù Extract and Decode Commands</h4>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Extract Encoded Arguments</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">grep -Poz '<rsp:Arguments>\K.*?(?=</rsp:Arguments>)' decrypted.txt > encoded.txt</code></pre>
                  </div>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Base64 Decode Commands</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <pre><code class="language-bash">while read line; do                                                     
  echo "$line" | base64 --decode >> arguments.txt
  echo "" >> arguments.txt
done < encoded_arguments.txt</code></pre>
                  </div>

                  <div class="code-block">
                    <div class="code-header">
                      <span class="code-title">Extract Readable Commands</span>
                      <button class="copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
<pre><code class="language-bash"></code></pre>
                  </div>

                  <div class="success-box">
                    <h4>üéâ Investigation Complete!</h4>
                    <p>
                      Through systematic analysis of the PCAP file, I successfully traced the complete 
                      attack timeline from initial port scanning to command execution.
                    </p>
                  </div>
                </div>
              </section>

       <section id="takeaways" class="content-section">
                <h2>
                  <i class="fas fa-lightbulb"></i>
                  Key Takeaways
                </h2>
                <div class="takeaways-grid">
                  <div class="takeaway-card">
                    <h4>üîç Network Forensics Fundamentals</h4>
                    <p>
                      PCAP analysis is crucial for incident response. Understanding how to extract and analyze 
                      network traffic helps reconstruct attack timelines and identify IOCs.
                    </p>
                  </div>
                  <div class="takeaway-card">
                    <h4>üõ†Ô∏è Multiple Tool Approach</h4>
                    <p>
                      Combining Wireshark GUI analysis with Tshark command-line filtering provides comprehensive 
                      network investigation capabilities for different types of evidence.
                    </p>
                  </div>
                  <div class="takeaway-card">
                    <h4>ÔøΩ Kerberos Attack Vectors</h4>
                    <p>
                      AS-REP roasting attacks target users with "Do not require Kerberos preauthentication" 
                      enabled, allowing offline password cracking of captured hashes.
                    </p>
                  </div>
                  <div class="takeaway-card">
                    <h4>üõ°Ô∏è Defensive Measures</h4>
                    <p>
                      Implement proper network monitoring, disable unnecessary Kerberos pre-authentication, 
                      use strong passwords, and monitor WinRM traffic for suspicious activity.
                    </p>
                  </div>
                </div>

                <div class="learning-resources">
                  <h3>Additional Learning Resources</h3>
                  <ul>
                    <li><a href="https://tryhackme.com/path/outline/blueteam" target="_blank">TryHackMe Blue Team Path</a></li>
                    <li><a href="https://www.wireshark.org/docs/" target="_blank">Wireshark Documentation</a></li>
                    <li><a href="https://attack.mitre.org/techniques/T1558/004/" target="_blank">MITRE ATT&CK - AS-REP Roasting</a></li>
                    <li><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-kerberos-authentication-service" target="_blank">Kerberos Security Monitoring</a></li>
                  </ul>
                </div>

                <div class="methodology-summary">
                  <h3>üéØ Investigation Methodology Applied</h3>
                  <div class="methodology-steps">
                    <div class="method-step completed">
                      <div class="step-number">‚úì</div>
                      <div class="step-content">
                        <h4>Evidence Collection</h4>
                        <p>I downloaded and safely analyzed the PCAP file in an isolated environment</p>
                      </div>
                    </div>
                    <div class="method-step completed">
                      <div class="step-number">‚úì</div>
                      <div class="step-content">
                        <h4>Traffic Analysis</h4>
                        <p>I identified source IPs, attack patterns, and communication protocols</p>
                      </div>
                    </div>
                    <div class="method-step completed">
                      <div class="step-number">‚úì</div>
                      <div class="step-content">
                        <h4>Credential Extraction</h4>
                        <p>I extracted and cracked Kerberos hashes to recover compromised credentials</p>
                      </div>
                    </div>
                    <div class="method-step completed">
                      <div class="step-number">‚úì</div>
                      <div class="step-content">
                        <h4>Command Analysis</h4>
                        <p>I decrypted WinRM traffic to reveal exact commands executed by the attacker</p>
                      </div>
                    </div>
                    <div class="method-step completed">
                      <div class="step-number">‚úì</div>
                      <div class="step-content">
                        <h4>Timeline Reconstruction</h4>
                        <p>I built complete attack timeline from initial reconnaissance to post-exploitation</p>
                      </div>
                    </div>
                  </div>
                </div>
              </section>
            </div>
          </div>
        </section>

        <section class="writeup-navigation">
          <div class="nav-container">
            <a href="index.html" class="nav-btn prev">
              <i class="fas fa-arrow-left"></i>
              Back to Writeups
            </a>
            <div class="nav-info">
              <span>Room Completed</span>
              <div class="completion-badge">
                <i class="fas fa-check-circle"></i>
              </div>
            </div>
          </div>
        </section>
      </main>

      <footer class="footer">
        <div class="footer-content">
          <div class="footer-section">
            <h3>Get In Touch</h3>
            <p>
              Let's connect and discuss cybersecurity, cloud engineering, or
              potential collaborations!
            </p>
          </div>

          <div class="footer-section">
            <h3>Quick Links</h3>
            <ul class="footer-links">
              <li><a href="../projects/index.html">Projects</a></li>
              <li><a href="index.html">TryHackMe</a></li>
              <li><a href="../articles/index.html">Articles</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>Connect</h3>
            <div class="footer-social">
              <a href="https://x.com/IbraheemA50" target="_blank"
                ><i class="fab fa-twitter"></i
              ></a>
              <a
                href="https://www.linkedin.com/in/ademiloye-al-hanif-ibraheem-4b5a3027a/"
                target="_blank"
                ><i class="fab fa-linkedin"></i
              ></a>
              <a href="mailto:ademiloyealhanifibraheem@gmail.com"
                ><i class="fas fa-envelope"></i
              ></a>
              <a href="https://github.com/IbraheemA05" target="_blank"
                ><i class="fab fa-github"></i
              ></a>
            </div>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2025 Ibraheem Ademiloye. All rights reserved.</p>
          <p class="footer-motto">Defensive By Offensive!</p>
        </div>
      </footer>
    </div>

    <style>
      /* Writeup-specific styles */
      .writeup-hero {
        padding: 6rem 2rem 4rem;
        background: var(--gradient-dark);
        text-align: center;
      }

      .writeup-hero-content {
        max-width: 1000px;
        margin: 0 auto;
      }

      .breadcrumb {
        margin-bottom: 2rem;
        color: var(--text-secondary);
      }

      .breadcrumb a {
        color: var(--primary-color);
        text-decoration: none;
      }

      .breadcrumb span {
        margin: 0 0.5rem;
      }

      .writeup-hero-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .writeup-meta {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .meta-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        background: var(--background-medium);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        border: 1px solid var(--border-color);
      }

      .difficulty-easy {
        color: var(--primary-color) !important;
        font-weight: 600;
      }

      .writeup-description {
        font-size: 1.2rem;
        color: var(--text-secondary);
        line-height: 1.6;
        max-width: 800px;
        margin: 0 auto;
      }

      .writeup-content {
        padding: 4rem 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      .content-container {
        display: grid;
        grid-template-columns: 250px 1fr;
        gap: 3rem;
      }

      .table-of-contents {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        height: fit-content;
        position: sticky;
        top: 2rem;
      }

      .table-of-contents h3 {
        color: var(--primary-color);
        margin-bottom: 1rem;
        font-size: 1.2rem;
      }

      .table-of-contents ul {
        list-style: none;
      }

      .table-of-contents li {
        margin-bottom: 0.5rem;
      }

      .table-of-contents a {
        color: var(--text-secondary);
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .table-of-contents a:hover {
        color: var(--primary-color);
      }

      .content-section {
        margin-bottom: 4rem;
      }

      .content-section h2 {
        font-size: 2rem;
        color: var(--primary-color);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        /* border-bottom removed to eliminate line over text */
        padding-bottom: 0.5rem;
      }

      .content-section h3 {
        font-size: 1.5rem;
        color: var(--text-primary);
        margin-top: 2rem;
        margin-bottom: 1rem;
      }

      .info-box {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        margin: 1.5rem 0;
      }

      .room-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 1.5rem;
      }

      .stat {
        background: var(--background-dark);
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid var(--border-color);
      }

      .code-block {
        background: var(--background-dark);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        margin: 1.5rem 0;
        overflow: hidden;
      }

      .code-header {
        background: var(--background-medium);
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .code-title {
        color: var(--text-primary);
        font-weight: 600;
      }

      .copy-btn {
        background: var(--primary-color);
        color: var(--background-dark);
        border: none;
        padding: 0.5rem;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .copy-btn:hover {
        background: var(--text-primary);
      }

      .code-block pre {
        padding: 1.5rem;
        margin: 0;
        font-family: 'Fira Code', monospace;
        color: var(--primary-color);
        overflow-x: auto;
      }

      .results-box, .discovery-box {
        background: var(--background-medium);
        border-left: 4px solid var(--primary-color);
        padding: 1.5rem;
        margin: 1.5rem 0;
        border-radius: 0 8px 8px 0;
      }

      .step-list {
        margin: 1.5rem 0;
      }

      .step {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        margin-bottom: 1.5rem;
        background: var(--background-medium);
        padding: 1.5rem;
        border-radius: 12px;
        border: 1px solid var(--border-color);
      }

      .step-number {
        width: 40px;
        height: 40px;
        background: var(--gradient-primary);
        color: var(--background-dark);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        flex-shrink: 0;
      }

      .flag-hunt {
        margin: 2rem 0;
      }

      .flag-result {
        background: rgba(0, 255, 136, 0.1);
        border: 1px solid var(--primary-color);
        border-radius: 8px;
        padding: 1rem;
        margin: 1rem 0;
      }

      .takeaways-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 2rem 0;
      }

      .takeaway-card {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        transition: all 0.3s ease;
      }

      .takeaway-card:hover {
        transform: translateY(-2px);
        border-color: var(--primary-color);
      }

      .takeaway-card h4 {
        color: var(--primary-color);
        margin-bottom: 1rem;
        font-size: 1.2rem;
      }

      .learning-resources {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        margin-top: 3rem;
      }

      .learning-resources h3 {
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .learning-resources ul {
        list-style: none;
      }

      .learning-resources li {
        margin-bottom: 0.5rem;
      }

      .learning-resources a {
        color: var(--text-secondary);
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .learning-resources a:hover {
        color: var(--primary-color);
      }

      .writeup-navigation {
        background: var(--background-medium);
        border-top: 1px solid var(--border-color);
        padding: 2rem;
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .nav-btn {
        background: var(--primary-color);
        color: var(--background-dark);
        padding: 0.75rem 1.5rem;
        border-radius: 25px;
        text-decoration: none;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
      }

      .nav-btn:hover {
        background: var(--text-primary);
        transform: translateX(-3px);
      }

      .nav-info {
        display: flex;
        align-items: center;
        gap: 1rem;
        color: var(--text-secondary);
      }

      .completion-badge {
        background: var(--primary-color);
        color: var(--background-dark);
        padding: 0.5rem;
        border-radius: 50%;
      }

      /* Room link styling */
      .room-link {
        margin: 1.5rem 0;
        text-align: center;
      }

      .thm-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        background: var(--primary-color);
        color: var(--background-dark);
        padding: 0.75rem 1.5rem;
        border-radius: 25px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .thm-link:hover {
        background: var(--text-primary);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px var(--shadow-color);
      }

      /* Scenario and warning boxes */
      .scenario-box {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        margin: 1.5rem 0;
      }

      .mission-objective {
        background: var(--background-dark);
        border-left: 4px solid var(--primary-color);
        padding: 1.5rem;
        margin: 1.5rem 0;
        border-radius: 0 8px 8px 0;
      }

      .warning-box {
        background: rgba(255, 107, 53, 0.1);
        border: 1px solid var(--accent-color);
        border-radius: 8px;
        padding: 1.5rem;
        margin: 1.5rem 0;
      }

      .warning-box h4 {
        color: var(--accent-color);
        margin-bottom: 1rem;
      }

      /* Question blocks */
      .question-block {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        margin: 2rem 0;
      }

      .question-block h3 {
        color: var(--primary-color);
        margin-bottom: 1rem;
        /* border-bottom removed to eliminate line over text */
        padding-bottom: 0.5rem;
      }

      .explanation-box {
        background: var(--background-dark);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 1rem;
        margin: 1rem 0;
        font-style: italic;
        color: var(--text-secondary);
      }

      .success-box {
        background: rgba(0, 255, 136, 0.1);
        border: 1px solid var(--primary-color);
        border-radius: 8px;
        padding: 1.5rem;
        margin: 1.5rem 0;
      }

      .success-box h4 {
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      /* Methodology summary */
      .methodology-summary {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        margin-top: 3rem;
      }

      .methodology-summary h3 {
        color: var(--primary-color);
        margin-bottom: 2rem;
        text-align: center;
        border-bottom: none;
      }

      .method-step.completed .step-number {
        background: var(--primary-color);
        color: var(--background-dark);
      }

      /* Image styling for writeups */
      .writeup-image {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        margin: 1.5rem 0;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease;
      }

      .writeup-image:hover {
        transform: scale(1.02);
        box-shadow: 0 8px 25px rgba(0, 255, 136, 0.1);
      }

      .image-container {
        text-align: center;
        margin: 2rem 0;
      }

      .image-caption {
        font-style: italic;
        color: var(--text-secondary);
        font-size: 0.9rem;
        margin-top: 0.5rem;
      }

      .image-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin: 2rem 0;
      }

      .screenshot-box {
        background: var(--background-medium);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1.5rem;
        margin: 1.5rem 0;
      }

      .screenshot-box h4 {
        color: var(--primary-color);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .writeup-hero-title {
          font-size: 2rem;
          flex-direction: column;
          gap: 0.5rem;
        }

        .writeup-meta {
          flex-direction: column;
          align-items: center;
        }

        .content-container {
          grid-template-columns: 1fr;
          gap: 2rem;
        }

        .table-of-contents {
          position: static;
          order: -1;
        }

        .takeaways-grid {
          grid-template-columns: 1fr;
        }

        .nav-container {
          flex-direction: column;
          gap: 1rem;
          text-align: center;
        }
      }
    </style>

    <script src="../../script.js"></script>
    <script>
      function copyCode(button) {
        const codeBlock = button.closest('.code-block').querySelector('code');
        const text = codeBlock.textContent;
        
        navigator.clipboard.writeText(text).then(() => {
          button.innerHTML = '<i class="fas fa-check"></i>';
          setTimeout(() => {
            button.innerHTML = '<i class="fas fa-copy"></i>';
          }, 2000);
        });
      }

      // Smooth scrolling for table of contents
      document.querySelectorAll('.table-of-contents a').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
    </script>
  </body>
</html>
